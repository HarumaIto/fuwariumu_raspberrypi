# ふわりうむ ラズパイソースコード

## セットアップ

**注:** 以下のセットアップ手順は、実行環境である**Raspberry Piデバイス上**で行うことを想定しています。 以降の作業は、**リポジトリ直下**で行います。


### 1. 仮想環境の作成 (初回のみ)

最初に、プロジェクト用のPython仮想環境を作成します。

```bash
python -m venv .venv
```

### 2. セットアップスクリプトへの実行権限の付与

`setup.sh`スクリプトを実行可能にするために、以下のコマンドを実行します。(Gitからクローンした場合など、初回に一度だけ実行する必要があります)

```bash
chmod +x setup.sh
```

### 3. 依存関係のインストール

準備が整ったら、以下のスクリプトを実行して必要なライブラリをすべてインストールします。

```bash
./setup.sh
```

スクリプトにより、仮想環境が有効化され、`requirements.txt` に記載された依存関係がインストールされます。

セットアップ完了後、仮想環境は有効なままです。作業を終了する場合や仮想環境を無効化したい場合は、以下のコマンドを実行してください。

```bash
deactivate
```

## 実行

アプリケーションを実行するには、以下のコマンドを使用します。

```bash
source .venv/bin/activate
python main.py
```

### モックを実行する場合
音楽生成には時間がかかるため、モックを実行するオプションを用意しています。  
この実行を行った場合、音楽を取得しにいくAPIがモック用となり、任意のタイミングでスイッチを押した時に再生処理を実行することができます。
```bash
source .venv/bin/activate
python main.py --is_mock
```

## 単体テスト
### LED
以下コマンドを実行することで、LEDのそれぞれの点灯動作を確認することができます。
```bash
python led.py
```

### サーボ
以下コマンドを実行することで、サーボの縦横の動作を実行することができます。
```bash
python servo.py
```